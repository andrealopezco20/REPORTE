<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reporte Musical Avanzado</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #6a5acd;
      --secondary-color: #9370db;
      --accent-color: #ff7f50;
      --light-color: #f8f9fa;
      --dark-color: #343a40;
      --success-color: #28a745;
      --info-color: #17a2b8;
      --warning-color: #ffc107;
      --danger-color: #dc3545;
      --text-color: #333;
      --text-light: #666;
      --bg-color: #f5f5f5;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Roboto', sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      line-height: 1.6;
      padding: 20px;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 30px;
      background-color: white;
      border-radius: 15px;
      box-shadow: 0 0 25px rgba(0, 0, 0, 0.1);
    }
    
    header {
      text-align: center;
      margin-bottom: 40px;
      padding-bottom: 25px;
      border-bottom: 1px solid #eee;
    }
    
    h1 {
      color: var(--primary-color);
      font-family: 'Montserrat', sans-serif;
      font-size: 2.8rem;
      margin-bottom: 15px;
      font-weight: 700;
    }
    
    .date-range {
      color: var(--text-light);
      font-size: 1.2rem;
      margin-bottom: 25px;
      font-weight: 300;
    }
    
    .section {
      margin-bottom: 50px;
      padding: 25px;
      background-color: white;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.05);
    }
    
    .section-title {
      color: var(--primary-color);
      font-family: 'Montserrat', sans-serif;
      font-size: 1.8rem;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 2px solid var(--secondary-color);
      font-weight: 600;
    }
    
    .grid-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 25px;
      margin-bottom: 35px;
    }
    
    .chart-container {
      position: relative;
      height: 380px; /* Reducido de 500px a 380px */
      background-color: white;
      padding: 12px; /* Reducido de 15px */
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.08);
      transition: all 0.3s ease;
      margin: 8px; /* Reducido de 10px */
      overflow: hidden;
    }
    
    canvas {
      display: block;
      width: 100% !important;
      height: 100% !important;
      max-width: 100%;
      max-height: 100%;
    }
    
    .chart-container:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }
    
    .chart-title {
      font-family: 'Montserrat', sans-serif;
      font-size: 1.1rem; /* Reducido de 1.2rem */
      color: var(--primary-color);
      margin-bottom: 12px; /* Reducido de 15px */
      text-align: center;
      font-weight: 600;
    }
    
    select {
      padding: 10px 15px; /* Reducido de 12px 18px */
      border: 1px solid #ddd;
      border-radius: 8px;
      background-color: white;
      font-size: 1rem;
      margin-bottom: 20px; /* Reducido de 25px */
      width: 100%;
      max-width: 350px;
      font-family: 'Roboto', sans-serif;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      transition: all 0.3s ease;
    }
    
    select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(106, 90, 205, 0.2);
    }
    
    .table-container {
      overflow-x: auto;
      margin-bottom: 25px; /* Reducido de 30px */
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 15px; /* Reducido de 20px */
    }
    
    th, td {
      padding: 12px 15px; /* Reducido de 15px 20px */
      text-align: left;
      border-bottom: 1px solid #eee;
    }
    
    th {
      background-color: var(--primary-color);
      color: white;
      font-weight: 500;
      text-transform: uppercase;
      font-size: 0.8rem; /* Reducido de 0.85rem */
      letter-spacing: 0.5px;
    }
    
    tr:nth-child(even) {
      background-color: #fafafa;
    }
    
    tr:hover {
      background-color: #f1f1f1;
    }
    
    .progress-container {
      margin-bottom: 20px; /* Reducido de 30px */
    }
    
    .progress-title {
      margin-bottom: 10px; /* Reducido de 12px */
      font-weight: 500;
      color: var(--text-color);
      font-size: 0.9rem; /* Reducido */
    }
    
    .progress-bar {
      height: 18px; /* Reducido de 20px */
      background-color: #e9ecef;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: inset 0 1px 2px rgba(0,0,0,0.1);
    }
    
    .progress {
      height: 100%;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
      border-radius: 10px;
      transition: width 0.6s ease;
      position: relative;
    }
    
    .progress::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(
        to right,
        rgba(255, 255, 255, 0.1) 0%,
        rgba(255, 255, 255, 0.3) 50%,
        rgba(255, 255, 255, 0.1) 100%
      );
      background-size: 200% 100%;
      animation: shimmer 2s infinite;
      border-radius: 10px;
    }
    
    @keyframes shimmer {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }
    
    .song-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 15px; /* Reducido de 20px */
      margin-bottom: 30px; /* Reducido de 40px */
    }
    
    .song-card {
      background-color: white;
      padding: 15px; /* Reducido de 20px */
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.08);
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
    }
    
    .song-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
    }
    
    .song-title {
      font-weight: 600;
      margin-bottom: 6px; /* Reducido de 8px */
      color: var(--dark-color);
      font-size: 1rem; /* Reducido de 1.1rem */
    }
    
    .song-artist {
      color: var(--text-light);
      font-size: 0.85rem; /* Reducido de 0.9rem */
      margin-bottom: 12px; /* Reducido de 15px */
    }
    
    .song-stats {
      margin-top: auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .song-count {
      background-color: var(--primary-color);
      color: white;
      padding: 4px 8px; /* Reducido de 5px 10px */
      border-radius: 20px;
      font-size: 0.75rem; /* Reducido de 0.8rem */
      font-weight: 500;
    }
    
    .song-emoji {
      font-size: 1rem; /* Reducido de 1.2rem */
    }
    
    .day-highlight {
      background-color: #f8f9fa;
      padding: 20px; /* Reducido de 25px */
      border-radius: 10px;
      margin-bottom: 25px; /* Reducido de 30px */
      border-left: 5px solid var(--primary-color);
    }
    
    .day-title {
      font-size: 1.4rem; /* Reducido de 1.5rem */
      color: var(--primary-color);
      margin-bottom: 12px; /* Reducido de 15px */
      font-weight: 600;
    }
    
    .day-stats {
      display: flex;
      flex-wrap: wrap;
      gap: 15px; /* Reducido de 20px */
      margin-bottom: 15px; /* Reducido de 20px */
    }
    
    .stat-card {
      flex: 1;
      min-width: 180px; /* Reducido de 200px */
      background-color: white;
      padding: 12px; /* Reducido de 15px */
      border-radius: 8px;
      box-shadow: 0 0 8px rgba(0, 0, 0, 0.05);
    }
    
    .stat-title {
      font-size: 0.85rem; /* Reducido de 0.9rem */
      color: var(--text-light);
      margin-bottom: 8px; /* Reducido de 10px */
    }
    
    .stat-value {
      font-size: 1.6rem; /* Reducido de 1.8rem */
      font-weight: 700;
      color: var(--primary-color);
    }
    
    @media (max-width: 1200px) {
      .container {
        padding: 25px; /* Reducido de 30px */
      }
      
      .grid-container {
        grid-template-columns: 1fr 1fr;
      }
    }
    
    @media (max-width: 768px) {
      .grid-container {
        grid-template-columns: 1fr;
      }
      
      .song-list {
        grid-template-columns: 1fr 1fr;
      }
      
      h1 {
        font-size: 2.2rem;
      }
      
      .section-title {
        font-size: 1.5rem;
      }
      
      .chart-container {
        height: 320px; /* Reducido de 450px */
        padding: 10px;
      }
    }
    
    @media (max-width: 480px) {
      .song-list {
        grid-template-columns: 1fr;
      }
      
      .container {
        padding: 20px; /* Reducido de 30px */
      }
      
      .section {
        padding: 20px; /* Reducido de 25px */
      }
      
      h1 {
        font-size: 1.8rem;
      }
      
      .chart-container {
        height: 280px; /* Reducido de 400px */
        padding: 8px;
      }
      
      .section-title {
        font-size: 1.3rem; /* Reducido de 1.5rem */
        margin-bottom: 20px; /* Reducido de 25px */
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üìä Reporte Musical</h1>
      <div class="date-range">24 abril 2025 - 2 mayo 2025</div>
    </header>
    
    <div class="section">
      <h2 class="section-title">Resumen General</h2>
      <div class="grid-container">
        <div class="chart-container">
          <div class="chart-title">Top 10 Canciones</div>
          <canvas id="cancionesChart"></canvas>
        </div>
        <div class="chart-container">
          <div class="chart-title">Distribuci√≥n de Emociones</div>
          <canvas id="emocionGeneralChart"></canvas>
        </div>
        <div class="chart-container">
          <div class="chart-title">Actividades m√°s Comunes</div>
          <canvas id="actividadGeneralChart"></canvas>
        </div>
        <div class="chart-container">
          <div class="chart-title">Uso de Plataformas</div>
          <canvas id="plataformaGeneralChart"></canvas>
        </div>
      </div>
    </div>
    
    <div class="section">
      <h2 class="section-title">An√°lisis por D√≠a</h2>
      <label for="daySelect">Selecciona un d√≠a:</label>
      <select id="daySelect"></select>
      
      <div id="dayHighlight" class="day-highlight">
        <div class="day-title" id="selectedDayTitle">D√≠a seleccionado: 24/04/2025</div>
        <div class="day-stats">
          <div class="stat-card">
            <div class="stat-title">Total Canciones</div>
            <div class="stat-value" id="totalSongs">0</div>
          </div>
          <div class="stat-card">
            <div class="stat-title">Emoci√≥n Principal</div>
            <div class="stat-value" id="mainEmotion">-</div>
          </div>
          <div class="stat-card">
            <div class="stat-title">Lugar Principal</div>
            <div class="stat-value" id="mainPlace">-</div>
          </div>
          <div class="stat-card">
            <div class="stat-title">Plataforma Principal</div>
            <div class="stat-value" id="mainPlatform">-</div>
          </div>
        </div>
      </div>
      
      <div class="grid-container">
        <div class="chart-container">
          <div class="chart-title">Lugares de Escucha</div>
          <canvas id="lugarChart"></canvas>
        </div>
        <div class="chart-container">
          <div class="chart-title">Plataformas Usadas</div>
          <canvas id="plataformaChart"></canvas>
        </div>
        <div class="chart-container">
          <div class="chart-title">Distribuci√≥n de Emociones</div>
          <canvas id="emocionChart"></canvas>
        </div>
        <div class="chart-container">
          <div class="chart-title">Actividades Realizadas</div>
          <canvas id="actividadChart"></canvas>
        </div>
        <div class="chart-container">
          <div class="chart-title">Dispositivos Usados</div>
          <canvas id="dispositivoChart"></canvas>
        </div>
        <div class="chart-container">
          <div class="chart-title">Emociones por Hora</div>
          <canvas id="horaEmocionChart"></canvas>
        </div>
      </div>
    </div>
    
    <div class="section">
      <h2 class="section-title">Canciones m√°s Escuchadas</h2>
      <div class="song-list" id="topSongsList"></div>
    </div>
    
    <div class="section">
      <h2 class="section-title">Actividad Reciente</h2>
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Fecha</th>
              <th>Canci√≥n</th>
              <th>Artista</th>
              <th>Emoci√≥n</th>
              <th>Actividad</th>
            </tr>
          </thead>
          <tbody id="recentActivity">
            <!-- Datos se llenar√°n con JavaScript -->
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <script>
    // Datos CSV (los mismos que proporcionaste)
    const csvContent = `D√≠a,Canci√≥n,Artista,Emoci√≥n,Lugar,Actividad,Plataforma,Dispositivo usado
24/04/2025,I can't Stop Me,TWICE,Energ√©tica,Cocina,Preparando desayuno,Spotify,Celular
24/04/2025,The Feels,TWICE,Alegre,Cocina,Preparando desayuno,Spotify,Celular
24/04/2025,PLAY,CHUNG HA,Divertida,Cocina,Preparando desayuno,Spotify,Celular
24/04/2025,Chicken Noodle Soup,J-hope feat. Becky G,Animada,Cocina,Preparando almuerzo,Spotify,Celular
24/04/2025,GOGOBEBE,MAMAMOO,Energ√©tica,Cocina,Preparando almuerzo,Spotify,Celular
24/04/2025,Diamonds,Rihanna,Motivacional,Cocina,Preparando almuerzo,Spotify,Celular
24/04/2025,My Heart Will Go On,Celine Dion,Nost√°lgica,Cocina,Preparando almuerzo,Spotify,Celular
24/04/2025,Perfect,Ed Sheeran,Rom√°ntica,Cocina,Preparando almuerzo,Spotify,Celular
24/04/2025,Neva Play,Megan Thee Stallion,Divertida,Cocina,Preparando almuerzo,Spotify,Celular
24/04/2025,Tomboy,Destiny Rogers,Empoderada,Cocina,Preparando almuerzo,Spotify,Celular
24/04/2025,It's Gonna Be Me,*NSYNC,Rom√°ntica,Cocina,Preparando almuerzo,Spotify,Celular
24/04/2025,Bye Bye Bye,*NSYNC,Nost√°lgica,Cocina,Preparando almuerzo,Spotify,Celular
24/04/2025,I'm In Love With a Monster,Fifth Harmony,Divertida,Cocina,Preparando almuerzo,Spotify,Celular
24/04/2025,Me Too,Meghan Trainor,Empoderada,Cuarto,Tomando un descanso,YouTube,Laptop
24/04/2025,Neva Play,Megan Thee Stallion,Divertida,Cuarto,Tomando un descanso,YouTube,Laptop
24/04/2025,Diamonds,Rihanna,Motivacional,Cuarto,Tomando un descanso,YouTube,Laptop
24/04/2025,Woman,Doja Cat,Empoderada,Cuarto,Tomando un descanso,YouTube,Laptop
24/04/2025,FRIENDS,Marshmello and Anne Marie,Alegre,Cuarto,Tomando un descanso,YouTube,Laptop
24/04/2025,I'm In Love With a Monster,Fifth Harmony,Divertida,Cuarto,Tomando un descanso,YouTube,Laptop
24/04/2025,Chandelier,Sia,Emocional,Cuarto,Tomando un descanso,YouTube,Laptop
24/04/2025,Cheap Thrills,Sia,Energ√©tica,Cuarto,Tomando un descanso,YouTube,Laptop
24/04/2025,The Greatest,Sia,Motivacional,Cuarto,Tomando un descanso,YouTube,Laptop
24/04/2025,Levitating,Dua Lipa,Alegre,Cuarto,Tomando un descanso,YouTube,Celular
24/04/2025,Se√±orita,"Shawn Mendes, Camila Cabello",Rom√°ntica,Cuarto,Tomando un descanso,YouTube,Celular
24/04/2025,The One That Got Away,Katy Perry,Nost√°lgica,Cuarto,Tomando un descanso,YouTube,Celular
25/04/2025,It's Gonna Be Me,*NSYNC,Nost√°lgica,Cocina,Preparando desayuno,Spotify,Celular
25/04/2025,Diamonds,Rihanna,Motivacional,Cocina,Preparando desayuno,Spotify,Celular
25/04/2025,Levitating,Dua Lipa,Alegre,Cocina,Preparando desayuno,Spotify,Celular
25/04/2025,Me Too,Meghan Trainor,Empoderada,Cocina,Preparando almuerzo,Spotify,Celular
25/04/2025,Cheap Thrills,Sia,Energ√©tica,Cocina,Preparando almuerzo,Spotify,Celular
25/04/2025,Bailando,Enrique Iglesias,Alegre,Cocina,Preparando almuerzo,Spotify,Celular
25/04/2025,Clandestino,"Shakira, Maluma",Rom√°ntica,Cocina,Preparando almuerzo,Spotify,Celular
25/04/2025,Taboo,Don Omar,Animada,Cocina,Preparando almuerzo,Spotify,Celular
26/04/2025,It's Gonna Be Me,*NSYNC,Rom√°ntica,Cuarto,Limpiando cuarto,Spotify,Celular
26/04/2025,Clandestino,"Shakira, Maluma",Rom√°ntica,Cuarto,Limpiando cuarto,Spotify,Celular
26/04/2025,Levitating,Dua Lipa,Alegre,Cuarto,Limpiando cuarto,Spotify,Celular
26/04/2025,Me Too,Meghan Trainor,Alegre,Cuarto,Limpiando cuarto,Spotify,Celular
26/04/2025,Cheap Thrills,Sia,Energ√©tica,Cuarto,Limpiando cuarto,Spotify,Celular
26/04/2025,Patito Juan,Granja de Zen√≥n,Divertida,Sala,Jugando con mi sobrina,YouTube,Celular
26/04/2025,El Gallo y la Pata,Granja de Zen√≥n,Divertida,Sala,Jugando con mi sobrina,YouTube,Celular
26/04/2025,Bartolito,Granja de Zen√≥n,Divertida,Sala,Jugando con mi sobrina,YouTube,Celular
26/04/2025,Soy una Serpiente,Las Canciones del Zoo 4,Divertida,Sala,Jugando con mi sobrina,YouTube,Celular
26/04/2025,Abejita Chiquitita,Plim Plim,Divertida,Sala,Jugando con mi sobrina,YouTube,Celular
26/04/2025,Soy una Taza,CantaJuego,Divertida,Sala,Jugando con mi sobrina,YouTube,Celular
26/04/2025,El Baile de la Ranita,Canciones de la Granja,Divertida,Sala,Jugando con mi sobrina,YouTube,Celular
27/04/2025,Diamonds,Rihanna,Motivacional,Cocina,Preparando desayuno,Spotify,Celular
27/04/2025,The Greatest,Sia,Motivacional,Cocina,Preparando desayuno,Spotify,Celular
27/04/2025,I'm In Love With a Monster,Fifth Harmony,Divertida,Cocina,Preparando desayuno,Spotify,Celular
27/04/2025,It's Gonna Be Me,*NSYNC,Nost√°lgica,Cocina,Preparando desayuno,Spotify,Celular
27/04/2025,¬øC√≥mo Me Ves?,Luna,Alegre,Cocina,Preparando desayuno,Spotify,Celular
28/04/2025,It's Gonna Be Me,*NSYNC,Rom√°ntica,Cuarto,Limpiando cuarto,YouTube,Celular
28/04/2025,I'm In Love With a Monster,Fifth Harmony,Divertida,Cuarto,Limpiando cuarto,YouTube,Celular
28/04/2025,Levitating,Dua Lipa,Alegre,Cuarto,Limpiando cuarto,YouTube,Celular
28/04/2025,FRIENDS,Marshmello and Anne Marie,Alegre,Cuarto,Limpiando cuarto,YouTube,Celular
28/04/2025,Attention,Charlie Puth,Relajada,Cuarto,Limpiando cuarto,YouTube,Celular
28/04/2025,There's Nothing Holdin Me Back,Shawn Mendes,Energ√©tica,Cuarto,Limpiando cuarto,YouTube,Celular
29/04/2025,It's Gonna Be Me,*NSYNC,Nost√°lgica,Cocina,Preparando almuerzo,Spotify,Celular
29/04/2025,I'm In Love With a Monster,Fifth Harmony,Divertida,Cocina,Preparando almuerzo,Spotify,Celular
29/04/2025,Me Too,Meghan Trainor,Empoderada,Cocina,Preparando almuerzo,Spotify,Celular
29/04/2025,Levitating,Dua Lipa,Alegre,Cocina,Preparando almuerzo,Spotify,Celular
29/04/2025,Attention,Charlie Puth,Relajada,Cocina,Preparando almuerzo,Spotify,Celular
29/04/2025,There's Nothing Holdin Me Back,Shawn Mendes,Energ√©tica,Cocina,Preparando almuerzo,Spotify,Celular
29/04/2025,La Tortura,Shakira feat. Alejandro Sanz,Rom√°ntica,Cocina,Preparando almuerzo,Spotify,Celular
29/04/2025,Don't Go Yet,Camila Cabello,Alegre,Cocina,Preparando almuerzo,Spotify,Celular
29/04/2025,Clandestino,"Shakira, Maluma",Rom√°ntica,Cocina,Preparando almuerzo,Spotify,Celular
29/04/2025,Se√±orita,"Shawn Mendes, Camila Cabello",Rom√°ntica,Cocina,Preparando almuerzo,Spotify,Celular
29/04/2025,Baby One More Time,Britney Spears,Nost√°lgica,Cocina,Preparando almuerzo,Spotify,Celular
30/04/2025,Drama,Aespa,Rom√°ntica,Cocina,Preparando almuerzo,Spotify,Celular
30/04/2025,Lovesick Girls,Black Pink,Rom√°ntica,Cocina,Preparando almuerzo,Spotify,Celular
01/05/2025,Levitating,Dua Lipa,Rom√°ntica,Cuarto,Corrigiendo practicas alumnas de mi mam√°,YouTube,Laptop
01/05/2025,Diamonds,Rihanna,Motivacional,Cuarto,Corrigiendo practicas alumnas de mi mam√°,YouTube,Laptop
01/05/2025,Don't Go Yet,Camila Cabello,Rom√°ntica,Cuarto,Corrigiendo practicas alumnas de mi mam√°,YouTube,Laptop
01/05/2025,Se√±orita,"Shawn Mendes, Camila Cabello",Rom√°ntica,Cuarto,Corrigiendo practicas alumnas de mi mam√°,YouTube,Laptop
01/05/2025,Havana,Camila Cabello,Rom√°ntica,Cuarto,Corrigiendo practicas alumnas de mi mam√°,YouTube,Laptop
01/05/2025,Cupid,FIFTY FIFTY,Rom√°ntica,Cuarto,Corrigiendo practicas alumnas de mi mam√°,YouTube,Laptop
01/05/2025,Me Too,Meghan Trainor,Empoderada,Cuarto,Corrigiendo practicas alumnas de mi mam√°,YouTube,Laptop
01/05/2025,Rolling in the Deep,Adele,Nost√°lgica,Cuarto,Corrigiendo practicas alumnas de mi mam√°,YouTube,Laptop
01/05/2025,Cheap Thrills,Sia,Motivacional,Cuarto,Corrigiendo practicas alumnas de mi mam√°,YouTube,Laptop
01/05/2025,Baby One More Time,Brtiney Spears,Nost√°lgica,Cuarto,Corrigiendo practicas alumnas de mi mam√°,YouTube,Laptop
01/05/2025,Flowers,Miley Cyrus,Empoderada,Cuarto,Corrigiendo practicas alumnas de mi mam√°,YouTube,Laptop
01/05/2025,ILLELLA,MAMAMOO,Alegre,Cuarto,Corrigiendo practicas alumnas de mi mam√°,YouTube,Laptop
01/05/2025,Clandestino,"Shakira, Maluma",Rom√°ntica,Cocina,Preparando almuerzo,Spotify,Celular
01/05/2025,Rechazame,Prince Royce,Rom√°ntica,Cocina,Preparando almuerzo,Spotify,Celular
01/05/2025,La Tortura,Shakira feat. Alejandro Sanz,Rom√°ntica,Cocina,Preparando almuerzo,Spotify,Celular
01/05/2025,La Bicicleta,"Carlos Vives, Shakira",Rom√°ntica,Cocina,Preparando almuerzo,Spotify,Celular
01/05/2025,Besos en Guerra,Morat Juanes,Rom√°ntica,Cocina,Preparando almuerzo,Spotify,Celular
01/05/2025,Imitadora,Romeo Santos,Rom√°ntica,Cocina,Preparando almuerzo,Spotify,Celular
01/05/2025,Borro Cassette,Maluma,Rom√°ntica,Cocina,Preparando almuerzo,Spotify,Celular
01/05/2025,Addicted To You,Shakira,Rom√°ntica,Cocina,Preparando almuerzo,Spotify,Celular
01/05/2025,Me enamor√©,Shakira,Rom√°ntica,Cocina,Preparando almuerzo,Spotify,Celular
01/05/2025,Mujeriego ,Ryan Castro,Alegre,Cocina,Preparando almuerzo,Spotify,Celular
01/05/2025,La despedida,Daddy Yankee,Rom√°ntica,Cuarto,Haciendo tareas,YouTube,Laptop
01/05/2025,"Ciega, Sordomuda",Shakira,Rom√°ntica,Cuarto,Haciendo tareas,YouTube,Laptop
01/05/2025,Bailando,Enrique Iglesias,Rom√°ntica,Cuarto,Haciendo tareas,YouTube,Laptop
01/05/2025,It's Gonna Be Me,*NSYNC,Rom√°ntica,Cuarto,Haciendo tareas,YouTube,Laptop
01/05/2025,We don¬¥t Talk Anymore,Charlie Puth,Nost√°lgica,Cuarto,Haciendo tareas,YouTube,Laptop
01/05/2025,Seven,Jung Kook,Rom√°ntica,Cuarto,Haciendo tareas,YouTube,Laptop
01/05/2025,Rolling in the Deep,Adele,Nost√°lgica,Cuarto,Haciendo tareas,YouTube,Laptop
01/05/2025,Diamonds,Rihanna,Motivacional,Cuarto,Haciendo tareas,YouTube,Laptop
01/05/2025,Se√±orita,"Shawn Mendes, Camila Cabello",Rom√°ntica,Cuarto,Haciendo tareas,YouTube,Laptop
01/05/2025,Clandestino,"Shakira, Maluma",Rom√°ntica,Cuarto,Haciendo tareas,YouTube,Laptop
01/05/2025,Levitating,Dua Lipa,Rom√°ntica,Cuarto,Haciendo tareas,YouTube,Laptop`;

    let allData = [];
    let charts = {};

    // Colores personalizados para los gr√°ficos
    const chartColors = [
      '#6a5acd', '#9370db', '#ff7f50', '#ffa07a', '#20b2aa', 
      '#32cd32', '#daa520', '#4169e1', '#8a2be2', '#ff6347',
      '#4682b4', '#9acd32', '#40e0d0', '#ff69b4', '#ba55d3'
    ];

    // Emojis para emociones
    const emotionEmojis = {
      'Energ√©tica': '‚ö°',
      'Alegre': 'üòä',
      'Divertida': 'üòÇ',
      'Animada': 'üéâ',
      'Motivacional': 'üí™',
      'Nost√°lgica': 'üï∞Ô∏è',
      'Rom√°ntica': '‚ù§Ô∏è',
      'Empoderada': 'üëë',
      'Emocional': 'ü•≤',
      'Relajada': 'üòå'
    };

    Papa.parse(csvContent, {
      header: true,
      skipEmptyLines: true,
      complete: function(results) {
        allData = results.data;
        generarGraficosIniciales();
        cargarDias();
        mostrarTopCanciones();
        mostrarActividadReciente();
      }
    });

    function generarGraficosIniciales() {
      // Gr√°fico de canciones m√°s escuchadas
      const canciones = {};
      allData.forEach(row => {
        canciones[row.Canci√≥n] = (canciones[row.Canci√≥n] || 0) + 1;
      });
      
      // Ordenar canciones por frecuencia
      const cancionesOrdenadas = Object.entries(canciones)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 10);

      const ctxCanciones = document.getElementById('cancionesChart').getContext('2d');
      charts.cancionesChart = new Chart(ctxCanciones, {
        type: 'doughnut',
        data: {
          labels: cancionesOrdenadas.map(item => item[0]),
          datasets: [{
            data: cancionesOrdenadas.map(item => item[1]),
            backgroundColor: chartColors.slice(0, cancionesOrdenadas.length),
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'right',
              labels: {
                font: {
                  size: 11 // Texto de leyenda m√°s peque√±o
                }
              }
            },
            title: {
              display: true,
              text: 'Top 10 Canciones',
              font: {
                size: 13 // T√≠tulo m√°s peque√±o
              }
            }
          }
        }
      });

      // Gr√°fico de emociones generales
      const emociones = {};
      allData.forEach(row => {
        emociones[row.Emoci√≥n] = (emociones[row.Emoci√≥n] || 0) + 1;
      });

      const ctxEmociones = document.getElementById('emocionGeneralChart').getContext('2d');
      charts.emocionGeneralChart = new Chart(ctxEmociones, {
        type: 'polarArea',
        data: {
          labels: Object.keys(emociones),
          datasets: [{
            data: Object.values(emociones),
            backgroundColor: chartColors.slice(0, Object.keys(emociones).length),
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: {
              display: true,
              text: 'Distribuci√≥n de Emociones',
              font: {
                size: 13
              }
            },
            legend: {
              labels: {
                font: {
                  size: 11
                }
              }
            }
          }
        }
      });

      // Gr√°fico de actividades generales
      const actividades = {};
      allData.forEach(row => {
        actividades[row.Actividad] = (actividades[row.Actividad] || 0) + 1;
      });

      const ctxActividades = document.getElementById('actividadGeneralChart').getContext('2d');
      charts.actividadGeneralChart = new Chart(ctxActividades, {
        type: 'bar',
        data: {
          labels: Object.keys(actividades),
          datasets: [{
            label: 'Reproducciones',
            data: Object.values(actividades),
            backgroundColor: chartColors.slice(0, Object.keys(actividades).length),
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: {
              display: true,
              text: 'Actividades m√°s Comunes',
              font: {
                size: 13
              }
            },
            legend: {
              display: false
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                stepSize: 1,
                font: {
                  size: 11
                }
              }
            },
            x: {
              ticks: {
                font: {
                  size: 11
                }
              }
            }
          }
        }
      });

      // Gr√°fico de plataformas generales
      const plataformas = {};
      allData.forEach(row => {
        plataformas[row.Plataforma] = (plataformas[row.Plataforma] || 0) + 1;
      });

      const ctxPlataformas = document.getElementById('plataformaGeneralChart').getContext('2d');
      charts.plataformaGeneralChart = new Chart(ctxPlataformas, {
        type: 'pie',
        data: {
          labels: Object.keys(plataformas),
          datasets: [{
            data: Object.values(plataformas),
            backgroundColor: chartColors.slice(0, Object.keys(plataformas).length),
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: {
              display: true,
              text: 'Uso de Plataformas',
              font: {
                size: 13
              }
            },
            legend: {
              labels: {
                font: {
                  size: 11
                }
              }
            }
          }
        }
      });
    }

    function cargarDias() {
      const dias = [...new Set(allData.map(row => row.D√≠a))].sort();
      const select = document.getElementById('daySelect');
      
      dias.forEach(d => {
        const option = document.createElement('option');
        option.value = d;
        option.textContent = d;
        select.appendChild(option);
      });
      
      select.addEventListener('change', () => actualizarGraficosPorDia(select.value));
      actualizarGraficosPorDia(dias[0]);
    }

    function actualizarGraficosPorDia(dia) {
      const filtrado = allData.filter(row => row.D√≠a === dia);
      
      // Actualizar t√≠tulo del d√≠a seleccionado
      document.getElementById('selectedDayTitle').textContent = `D√≠a seleccionado: ${dia}`;
      
      // Actualizar estad√≠sticas principales
      document.getElementById('totalSongs').textContent = filtrado.length;
      
      // Calcular emoci√≥n principal
      const emociones = {};
      filtrado.forEach(row => {
        emociones[row.Emoci√≥n] = (emociones[row.Emoci√≥n] || 0) + 1;
      });
      const mainEmotion = Object.entries(emociones).sort((a, b) => b[1] - a[1])[0];
      document.getElementById('mainEmotion').textContent = `${mainEmotion[0]} (${mainEmotion[1]})`;
      
      // Calcular lugar principal
      const lugares = {};
      filtrado.forEach(row => {
        lugares[row.Lugar] = (lugares[row.Lugar] || 0) + 1;
      });
      const mainPlace = Object.entries(lugares).sort((a, b) => b[1] - a[1])[0];
      document.getElementById('mainPlace').textContent = `${mainPlace[0]} (${mainPlace[1]})`;
      
      // Calcular plataforma principal
      const plataformas = {};
      filtrado.forEach(row => {
        plataformas[row.Plataforma] = (plataformas[row.Plataforma] || 0) + 1;
      });
      const mainPlatform = Object.entries(plataformas).sort((a, b) => b[1] - a[1])[0];
      document.getElementById('mainPlatform').textContent = `${mainPlatform[0]} (${mainPlatform[1]})`;

      // Gr√°fico de lugares
      crearBarChart('lugarChart', lugares, 'Lugares de Escucha');
      
      // Gr√°fico de plataformas
      crearBarChart('plataformaChart', plataformas, 'Plataformas Usadas');
      
      // Gr√°fico de emociones
      crearPieChart('emocionChart', emociones, 'Emociones del D√≠a');
      
      // Gr√°fico de actividades
      const actividades = {};
      filtrado.forEach(row => {
        actividades[row.Actividad] = (actividades[row.Actividad] || 0) + 1;
      });
      crearBarChart('actividadChart', actividades, 'Actividades Realizadas');
      
      // Gr√°fico de dispositivos
      const dispositivos = {};
      filtrado.forEach(row => {
        dispositivos[row['Dispositivo usado']] = (dispositivos[row['Dispositivo usado']] || 0) + 1;
      });
      crearPieChart('dispositivoChart', dispositivos, 'Dispositivos Usados');
      
      // Gr√°fico de emociones por hora (simulado)
      const horas = {
        '08:00': { 'Energ√©tica': 2, 'Alegre': 1 },
        '12:00': { 'Motivacional': 3, 'Divertida': 2 },
        '18:00': { 'Rom√°ntica': 4, 'Nost√°lgica': 1 }
      };
      crearEmocionesPorHoraChart('horaEmocionChart', horas);
    }

    function crearBarChart(id, data, title) {
      const ctx = document.getElementById(id).getContext('2d');
      
      if (charts[id]) charts[id].destroy();
      
      charts[id] = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: Object.keys(data),
          datasets: [{
            label: 'Reproducciones',
            data: Object.values(data),
            backgroundColor: chartColors.slice(0, Object.keys(data).length),
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: {
              display: true,
              text: title,
              font: {
                size: 13
              }
            },
            legend: {
              display: false
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                stepSize: 1,
                font: {
                  size: 11
                }
              }
            },
            x: {
              ticks: {
                font: {
                  size: 11
                }
              }
            }
          }
        }
      });
    }

    function crearPieChart(id, data, title) {
      const ctx = document.getElementById(id).getContext('2d');
      
      if (charts[id]) charts[id].destroy();
      
      charts[id] = new Chart(ctx, {
        type: 'pie',
        data: {
          labels: Object.keys(data),
          datasets: [{
            data: Object.values(data),
            backgroundColor: chartColors.slice(0, Object.keys(data).length),
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: {
              display: true,
              text: title,
              font: {
                size: 13
              }
            },
            legend: {
              labels: {
                font: {
                  size: 11
                }
              }
            }
          }
        }
      });
    }

    function crearEmocionesPorHoraChart(id, data) {
      const horas = Object.keys(data);
      const emociones = [...new Set(Object.values(data).flatMap(h => Object.keys(h)))];
      
      const datasets = emociones.map(emocion => {
        return {
          label: emocion,
          data: horas.map(hora => data[hora][emocion] || 0),
          backgroundColor: chartColors[emociones.indexOf(emocion) % chartColors.length],
          borderWidth: 1
        };
      });
      
      const ctx = document.getElementById(id).getContext('2d');
      
      if (charts[id]) charts[id].destroy();
      
      charts[id] = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: horas,
          datasets: datasets
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: {
              display: true,
              text: 'Emociones por Hora',
              font: {
                size: 13
              }
            },
            legend: {
              labels: {
                font: {
                  size: 11
                }
              }
            }
          },
          scales: {
            x: {
              stacked: true,
              ticks: {
                font: {
                  size: 11
                }
              }
            },
            y: {
              stacked: true,
              beginAtZero: true,
              ticks: {
                stepSize: 1,
                font: {
                  size: 11
                }
              }
            }
          }
        }
      });
    }

    function mostrarTopCanciones() {
      const canciones = {};
      allData.forEach(row => {
        canciones[row.Canci√≥n] = (canciones[row.Canci√≥n] || 0) + 1;
      });
      
      // Ordenar canciones por frecuencia y tomar las top 12
      const topCanciones = Object.entries(canciones)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 12);
      
      const songList = document.getElementById('topSongsList');
      songList.innerHTML = '';
      
      topCanciones.forEach(([cancion, count]) => {
        // Encontrar el primer registro para esta canci√≥n para obtener el artista y emoci√≥n
        const primerRegistro = allData.find(row => row.Canci√≥n === cancion);
        
        const songCard = document.createElement('div');
        songCard.className = 'song-card';
        songCard.innerHTML = `
          <div class="song-title">${cancion}</div>
          <div class="song-artist">${primerRegistro.Artista}</div>
          <div class="song-stats">
            <div class="song-count">${count} rep.</div>
            <div class="song-emoji">${emotionEmojis[primerRegistro.Emoci√≥n] || 'üéµ'}</div>
          </div>
          <div class="progress-container">
            <div class="progress-bar">
              <div class="progress" style="width: ${(count / topCanciones[0][1]) * 100}%"></div>
            </div>
          </div>
        `;
        songList.appendChild(songCard);
      });
    }

    function mostrarActividadReciente() {
      const tbody = document.getElementById('recentActivity');
      tbody.innerHTML = '';
      
      // Ordenar datos por fecha (m√°s reciente primero)
      const datosOrdenados = [...allData].sort((a, b) => new Date(b.D√≠a) - new Date(a.D√≠a));
      
      // Mostrar solo las 15 m√°s recientes
      datosOrdenados.slice(0, 15).forEach(row => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${row.D√≠a}</td>
          <td>${row.Canci√≥n}</td>
          <td>${row.Artista}</td>
          <td>${row.Emoci√≥n}</td>
          <td>${row.Actividad}</td>
        `;
        tbody.appendChild(tr);
      });
    }
  </script>
</body>
</html>